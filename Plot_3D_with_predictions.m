clrMap = lines(2);
figDir = ...
    "C:\Users\neuro\seadrive_root\Emilio U\Shared with groups"+...
    "\GDrive GrohLab\Projects\00 Data Transfer\Toni";
fig = figure('Name', 'POm and VPM classification', 'Color','w');
gtSct = scatter3(RecDB.CellAtlasCoords(Cell_numbers,1), ...
    -RecDB.CellAtlasCoords(Cell_numbers,2), ...
    -RecDB.CellAtlasCoords(Cell_numbers,3), [], ...
    clrMap(double(True_Labels)+1,:), "filled");
clrCmd = "{\\color[rgb]{%s}%s}";
ttlStr = sprintf(clrCmd, join(string(clrMap(1,:))), "POm") + " and " +...
    sprintf(clrCmd, join(string(clrMap(2,:))), "VPM") + " ground truth" + ...
    " (\bullet) and predictions (\circ)";
% title("{\color[rgb]{0 0.447 0.741}POm} and {\color[rgb]{0.85 0.325
% 0.098}VPM} predictions")
hold on; pSct = scatter3(RecDB.CellAtlasCoords(Cell_numbers,1), ...
    -RecDB.CellAtlasCoords(Cell_numbers,2), ...
    -RecDB.CellAtlasCoords(Cell_numbers,3), 90, ...
    clrMap(double(Predicted_Lables)+1,:), "LineWidth", 1);

% hold on; pSct = scatter3(RecDB.CellAtlasCoords(Cell_numbers(True_Labels ~= Predicted_Lables),1), ...
%     -RecDB.CellAtlasCoords(Cell_numbers(True_Labels ~= Predicted_Lables),2), ...
%     -RecDB.CellAtlasCoords(Cell_numbers(True_Labels ~= Predicted_Lables),3), 108, ...
%     "r", "Marker", "x", "LineWidth", 2);

title(ttlStr)
lgObj = legend({'Ground truth','Predictions'});
set(lgObj, "Box", "off", "Color", "none", "Location", "best")
set(gca, "Box", "off", "Color", "none", "Clipping", "off", ...
    "CameraPosition", 1.0e+04*[0.5315, -1.0742, -0.0368]);
axis([1200, 2100, -2300, -1300, -3500, -2700])
xticks(1200:400:2000); yticks(-2200:400:-1400); zticks(-3400:200:-2800)
xlabel("Medial \leftrightarrow Lateral [\mum]");
ylabel("Posterior \leftrightarrow Anterior [\mum]");
zlabel("Ventral \leftrightarrow Dorsal [\mum]");

saveFigure(fig, fullfile(figDir, "Anatomy predictions based on ephys"), 1, 1)
close(fig); clearvars *Sct fig lgObj; 
save(fullfile(figDir, "Data.mat"))
